p8105_hw3_ys3924
================
YISU
2024-10-12

# Problem 1

### Read in and clean NY NOAA data

``` r
data("ny_noaa") 
ny_noaa = ny_noaa |>
  janitor::clean_names() |> 
  separate(date, c('year', 'month', 'day'), sep ='-') |>
  mutate(prcp = as.numeric(prcp),
         tmax = as.numeric(tmax),
         tmin = as.numeric(tmin),
         year = as.numeric(year),
         prcp = prcp / 10,
         tmax = tmax / 10,
         tmin = tmin / 10)
ny_noaa_row = nrow(ny_noaa)
```

The dataset contains key variables id, date, prcp, snow, tmin, tmax. The
dataset has 2595176 observations. There exists missing values for
temperature, precipitation, or snowfall, which can affect analysis if
not handled properly.

Count the snow fall

``` r
snowfall_counts = ny_noaa |>
  count(snow) |>
  arrange(desc(n)) |>
  slice(1)
snowfall_counts
```

    ## # A tibble: 1 × 2
    ##    snow       n
    ##   <int>   <int>
    ## 1     0 2008508

For snowfall, the most commonly observed values is 0, which contains
2008508 observations.

### Create plot showing the average max temperature in January and in July in each station across years

``` r
# Filter the data
jan_jul_temp = ny_noaa |>
  filter(month %in% c("01", "07")) |>
  group_by(id, year, month) |>
  drop_na(tmax) |>
  summarise(avg_max_temp = mean(tmax, na.rm = TRUE)) |>
  ungroup()

# Create the plot using the filtered data
  ggplot(jan_jul_temp, aes(x = year, y = avg_max_temp, color = id)) +
  geom_point(alpha = 0.5) +
  facet_wrap(~month, labeller = labeller(month = c("01" = "January", "07" = "July"))) +
  labs(title = "Average Max Temperature of Stations in January and July across Years and Stations",
       x = "Year",  
       y = "Average Max Temperature") + 
  theme_minimal() +
  theme(legend.position = "none")
```

![](p8105_hw3_ys3924_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

According to the above graph, average max temperature in July is higher
than in January, and temperatures appear to be more consistent during
July. The outliers exist for both January and July, where temperatures
drop significantly below the typical range for most stations.

### Create plot showing tmax vs tmin and distribution of snowfall values

``` r
# Plot for tmax vs tmin  for the full dataset
plot_i = ggplot(ny_noaa, aes(x = tmin, y = tmax)) +
  geom_hex() +
  labs(title = "tmax vs tmin for the full Dataset", x = "Min Temperature", y = "Max Temperature") +
  theme_minimal()
# Plot for distribution of snowfall values
plot_ii = ny_noaa |>
  filter(snow > 0 & snow < 100) |>
  group_by(year) |>
  summarise(avg_snow = mean(snow, na.rm = TRUE)) |>
  ggplot(aes(x = year, y = avg_snow)) +
  geom_col(width = 0.7) +
  labs(title = "Snowfall Distribution by Year", x = "Year", y = "Average Snowfall") +
  theme_minimal()
plot_i + plot_ii
```

![](p8105_hw3_ys3924_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

# Problem 2

### Read in and clean accelerometer and demographic data

``` r
accel_data = read_csv("./data/nhanes_accel.csv") |>
  janitor::clean_names() |>
  mutate(seqn = as.character(seqn))
covar_data = read_csv("./data/nhanes_covar.csv", skip = 3) |>
  janitor::row_to_names(row_number = 1) |>
  janitor::clean_names() |>
  mutate(
    sex = factor(sex, levels = c(1, 2), labels = c("Male", "Female")),
    education = factor(education, levels = c(1, 2, 3), 
                       labels = c("Less than high school",
                                  "High school equivalent",
                                  "More than high school")),
    age = as.numeric(age)
  ) |>
  drop_na() |>
  filter(age >= 21)
full_data = left_join(covar_data, accel_data, by = "seqn")
```

### Create table for the number of men and women in each education category

``` r
full_data |>
  group_by(sex, education) |>
  summarise(count = n()) |>
  pivot_wider(names_from = education, values_from = count) |>
  knitr::kable()
```

| sex    | Less than high school | High school equivalent | More than high school |
|:-------|----------------------:|-----------------------:|----------------------:|
| Male   |                    27 |                     35 |                    56 |
| Female |                    28 |                     23 |                    59 |

By looking at above table, there are slightly more women have achieved
higher levels of education (more than high school) compared to men,
while more men tend to fall in the “High school equivalent” category.
For education level less than high school, the balance between men and
women is fairly even.

### Create a visualization of the age distributions for men and women in each education category

``` r
ggplot(full_data, aes(x = education, y = age, fill = sex)) +
  geom_boxplot() +
  labs(title = "Age Distribution by Gender and Education Category", 
       x = "Education Category", 
       y = "Age") +
  theme_minimal()
```

![](p8105_hw3_ys3924_files/figure-gfm/unnamed-chunk-7-1.png)<!-- -->

According to above boxplot, the age distribution across education levels
shows that individuals with less education, particularly “Less than high
school”, tend to be slightly older. The “High school equivalent”
category shows a younger age range for men than women. For the “More
than high school” category, the distribution are similar, except that
the median age for men is higher than women.
